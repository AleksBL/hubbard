

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Simulating an open-quantum system with electron correlations &mdash; hubbard documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Publications using the hubbard package" href="../publications.html" />
    <link rel="prev" title="Electron correlations in periodic systems" href="periodic.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> hubbard
          

          
          </a>

          
            
            
              <div class="version">
                v0.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="molecules.html">Simulating a molecule with electron correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="periodic.html">Electron correlations in periodic systems</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Simulating an open-quantum system with electron correlations</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Publications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using the hubbard package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html#funding">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html#citing-the-hubbard-package">Citing the hubbard package</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hubbard</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Simulating an open-quantum system with electron correlations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/open.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="simulating-an-open-quantum-system-with-electron-correlations">
<h1>Simulating an open-quantum system with electron correlations<a class="headerlink" href="#simulating-an-open-quantum-system-with-electron-correlations" title="Permalink to this headline">¶</a></h1>
<p>In this example we will create the <em class="xref py py-obj">HubbardHamiltonian</em> object
of a system with open boundary conditions, and find the self-consistent solution using the mean-field Hubbard Hamiltonian.</p>
<p>We will model a perfect system, where we <em>know</em> that we should recover a perfect step-like transmission function.
You can also navigate through the
<a class="reference external" href="https://github.com/dipc-cc/hubbard/tree/master/examples/open">open-quantum systems section</a> in the main repository,
where more examples can be found.</p>
<p>The sysem of this example is composed by a central region coupled to two electrodes (left and right).
The central region in this case will be just a repetition of the unit-cell of the electrodes (perfect system),
for the sake of simplicity. We will consider the electrodes to be the unit cell of a zigzag graphene nanoribbon (ZGNR)
of width W=5 C-atoms across periodic along the x-axis.</p>
<p>We will focus on the equilibrium situation, therefore the temperature and chemical potentials of the electrodes <em>must coincide</em>.
The complex contour that we use to integrate the density matrix in the <a class="reference internal" href="../api-generated/hubbard.NEGF.html#hubbard.NEGF" title="hubbard.NEGF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hubbard.NEGF</span></code></a> class is extracted from a <a class="reference external" href="https://gitlab.com/siesta/-project/siesta">Transiesta</a> calculation
performed for a temperature of <em class="xref py py-obj">kT=0.025</em> eV, which we will set as common for all the composing element calculations.</p>
<ol class="arabic simple">
<li><p>We will start by building the tight-binding (TB) Hamiltonian for the graphene nanoribbons,
which compose the electrodes (periodic boundary conditions). Then we will find their self-consistent solution
by using the <a class="reference internal" href="../api-generated/hubbard.html#module-hubbard" title="hubbard"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hubbard</span></code></a> package.</p></li>
<li><p>We then have to build the geometry of the central region before we generate its sp2 TB Hamiltonian.</p></li>
<li><p>We will build the <em class="xref py py-obj">HubbardHamiltonian</em> object, which will allow us to use the routines
stored in this class to converge until we find the self-consistent solution.</p></li>
<li><p>In this case we will have to use a method based on the non-equilibrium Green’s function of the central region
to obtain the spin-densities. To do so, we can make use of the methods available in the <a class="reference internal" href="../api-generated/hubbard.NEGF.html#hubbard.NEGF" title="hubbard.NEGF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hubbard.NEGF</span></code></a> class.</p></li>
<li><p>Optionally, you can also compute the transmission function of the converged system using <a class="reference external" href="https://gitlab.com/siesta/-project/siesta">TBtrans</a>.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sisl</span>
<span class="kn">from</span> <span class="nn">hubbard</span> <span class="kn">import</span> <span class="n">HubbardHamiltonian</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">NEGF</span>

<span class="c1"># Build sisl.Geometry object of a ZGNR of width W=5 C-atoms across,</span>
<span class="c1"># e.g., by using the function sisl.geom.zgnr.</span>
<span class="c1"># This function returns a periodic ZGNR along the x-axis.</span>
<span class="n">ZGNR</span> <span class="o">=</span> <span class="n">sisl</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">zgnr</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Set U and kT for the whole calculation</span>
<span class="n">U</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">kT</span> <span class="o">=</span> <span class="mf">0.025</span>

<span class="c1"># Build tight-binding Hamiltonian using sp2 function</span>
<span class="n">H_elec</span> <span class="o">=</span> <span class="n">sp2</span><span class="p">(</span><span class="n">ZGNR</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="mf">2.7</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="mf">0.18</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s3</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Hubbard Hamiltonian of elecs</span>
<span class="n">MFH_elec</span> <span class="o">=</span> <span class="n">HubbardHamiltonian</span><span class="p">(</span><span class="n">H_elec</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">nkpt</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kT</span><span class="o">=</span><span class="n">kT</span><span class="p">)</span>

<span class="c1"># Converge Electrode Hamiltonians</span>
<span class="n">dn</span> <span class="o">=</span> <span class="n">MFH_elec</span><span class="o">.</span><span class="n">converge</span><span class="p">(</span><span class="n">density</span><span class="o">.</span><span class="n">calc_n</span><span class="p">)</span>

<span class="c1"># Central region is a repetition of the electrodes</span>
<span class="n">HC</span> <span class="o">=</span> <span class="n">H_elec</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># without periodic boundary conditions</span>
<span class="n">HC</span><span class="o">.</span><span class="n">set_nsc</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Map electrodes in the device region, i.e., extract the atomic indices that correspond</span>
<span class="c1"># to the electrodes inside the device region</span>
<span class="n">elec_indx</span> <span class="o">=</span> <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">H_elec</span><span class="p">)),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HC</span><span class="o">.</span><span class="n">H</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">H_elec</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">HC</span><span class="o">.</span><span class="n">H</span><span class="p">))]</span>

<span class="c1"># MFH object of the central region</span>
<span class="n">MFH_HC</span> <span class="o">=</span> <span class="n">HubbardHamiltonian</span><span class="p">(</span><span class="n">HC</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">kT</span><span class="o">=</span><span class="n">kT</span><span class="p">)</span>
<span class="c1"># Use initial random density</span>
<span class="n">MFH_HC</span><span class="o">.</span><span class="n">random_density</span><span class="p">()</span>

<span class="c1"># First create the NEGF object, where we pass the MFH converged electrodes and</span>
<span class="c1"># the central region HubbardHamiltonian object</span>
<span class="n">negf</span> <span class="o">=</span> <span class="n">NEGF</span><span class="p">(</span><span class="n">MFH_HC</span><span class="p">,</span> <span class="p">[(</span><span class="n">MFH_elec</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">MFH_elec</span><span class="p">,</span> <span class="s1">&#39;+A&#39;</span><span class="p">)],</span> <span class="n">elec_indx</span><span class="p">)</span>

<span class="c1"># Converge using Green&#39;s function method to obtain the densities</span>
<span class="n">dn</span> <span class="o">=</span> <span class="n">MFH_HC</span><span class="o">.</span><span class="n">converge</span><span class="p">(</span><span class="n">negf</span><span class="o">.</span><span class="n">calc_n_open</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">print_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Usually, each iteration using the non-equilibrium Green’s function formalism takes more time than if the system is finite or periodic.
This is due to the fact that for open quantum systems it has to invert the Green’s function matrix for each energy point along the
integration path in each iteration.
For this reason, using a good initial guess (initial spin-densities) can be crucial if we want the code to perform
less iterations to find the self-consistent solution.</p>
<p>Try again the example from above but using a specific initial guess for the spin-densities.
For instance, you could find the self-consistent solution for the device Hamiltonian with periodic boundary conditions
and use this spin-densities to start the convergence for the device with open boundary conditions.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../publications.html" class="btn btn-neutral float-right" title="Publications using the hubbard package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="periodic.html" class="btn btn-neutral float-left" title="Electron correlations in periodic systems" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2021, Sofia Sanz, Nick R. Papior, Mads Brandbyge and Thomas Frederiksen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>